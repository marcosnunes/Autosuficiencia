<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="description" content="Sua Calculadora Financeira Prática">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link rel="stylesheet" href="style.css">
  <title>Dízimo</title>
</head>

<body>
  <div class="navigation">
    <nav>
      <div class="nav-wrapper">
        <button id="backButton" class="btn btn-default">Voltar</button>
        <span class="brand-logo center">Dízimo</span>
        <button id="nextButton" class="btn btn-default">Próximo</button>
      </div>
    </nav>
  </div>
  <div class="container">
    <div class="card">
      <div class="card-content">
        <p>Nesta página você tem um relatório 
          dos seus dízimos.</p>
      </div>
    </div>
    <div class="balance-value" id="balanceValue">
      <div class="card">
        <div class="card-content">
          <span class="card-title">Totais mensais</span>
          <div class="card-balance-content">
            <div class="card-content">
              <span class="card-title">Jan</span>
              <p><span id="januaryTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Fev</span>
              <p><span id="februaryTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Mar</span>
              <p><span id="marchTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Abr</span>
              <p><span id="aprilTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Mai</span>
              <p><span id="mayTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Jun</span>
              <p><span id="juneTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Jul</span>
              <p><span id="julyTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Ago</span>
              <p><span id="augustTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Set</span>
              <p><span id="septemberTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Out</span>
              <p><span id="octoberTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Nov</span>
              <p><span id="novemberTithe">0.00</span></p>
            </div>
            <div class="card-content">
              <span class="card-title">Dez</span>
              <p><span id="decemberTithe">0.00</span></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script type="module">
      // Importa os módulos necessários do Firebase
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js';
      import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js';
      import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js';

      // Configuração do Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyAPvYiaaGlHaJMaJzXoifWHBmp1be04F80",
        authDomain: "web-app-autossuficiencia.firebaseapp.com",
        databaseURL: "https://web-app-autossuficiencia-default-rtdb.firebaseio.com",
        projectId: "web-app-autossuficiencia",
        appId: "1:702286825063:web:f16256bd9bfc7de3dcb6c2"
      };

      // Inicializa o Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const database = getDatabase(app);

      // Verificação do estado de autenticação
      onAuthStateChanged(auth, (user) => {
        if (user) {
          // Usuário autenticado, carregar os dados
          loadDataFromDatabase(user.uid);
        } else {
          // Usuário não autenticado, redirecionar para a página de login
          window.location.href = "login.html";
        }
      });

      function loadDataFromDatabase(userId) {
        // Referência aos dados do usuário no Firebase
        const userRef = ref(database, 'users/' + userId);

        // Listener para carregar os dados do dízimo de cada mês
        onValue(userRef, (snapshot) => {
          const userData = snapshot.val();

          // Atualiza os elementos HTML com os valores do dízimo
          document.getElementById("januaryTithe").textContent = (userData.january && userData.january.tithe) ? userData.january.tithe : "0.00";
          document.getElementById("februaryTithe").textContent = (userData.february && userData.february.tithe) ? userData.february.tithe : "0.00";
          document.getElementById("marchTithe").textContent = (userData.march && userData.march.tithe) ? userData.march.tithe : "0.00";
          document.getElementById("aprilTithe").textContent = (userData.april && userData.april.tithe) ? userData.april.tithe : "0.00";
          document.getElementById("mayTithe").textContent = (userData.may && userData.may.tithe) ? userData.may.tithe : "0.00";
          document.getElementById("juneTithe").textContent = (userData.june && userData.june.tithe) ? userData.june.tithe : "0.00";
          document.getElementById("julyTithe").textContent = (userData.july && userData.july.tithe) ? userData.july.tithe : "0.00";
          document.getElementById("augustTithe").textContent = (userData.august && userData.august.tithe) ? userData.august.tithe : "0.00";
          document.getElementById("septemberTithe").textContent = (userData.september && userData.september.tithe) ? userData.september.tithe : "0.00";
          document.getElementById("octoberTithe").textContent = (userData.october && userData.october.tithe) ? userData.october.tithe : "0.00";
          document.getElementById("novemberTithe").textContent = (userData.november && userData.november.tithe) ? userData.november.tithe : "0.00";
          document.getElementById("decemberTithe").textContent = (userData.december && userData.december.tithe) ? userData.december.tithe : "0.00";

        });
      }

      document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('backButton').addEventListener('click', function () {
          window.history.back();
        });
        document.getElementById('nextButton').addEventListener('click', function () {
          window.history.back();
        });
      });

    </script>
</body>

</html>
